# Проверка различных алгоритмов и структур данных на производительность.
## В [данном](https://github.com/dkoleev/PerformanceTestingInUnity) репозитории примеры тестов в юнити.

Характеристики компьютера на котором производились замеры:
![](https://github.com/dkoleev/PerformanceTesting/blob/master/Content/Images/pc_characteristic.png)

## 1. Эксперементы с кэшем процессора.
### Как локальность данных влияет на производительность.
В данных примерах рассматривается пространственная локальность (также существует временная).
### Немного теории прежде чем мы рассмотрим примеры.
В [презентации](https://docs.google.com/presentation/d/1zKsVoWUkBRu50UW5VW505fWX-KwT3m5T3WY_SnTajcs/edit#slide=id.g7f2a535f12_0_0) наглядно описано как устроена современная память и процессоры.
Итак, что нам нужно знать об устройстве компьютера для того чтобы писать оптимизированные программы:
+ Процессор чтобы начать вычисления не получает данные из памяти напрямую, а загружает данные из неё в свой кэш, а из кэша уже в регистры (если в кратце почему так - кэш реализован на основе технологии SRAM (быстро но дорого), основаня память на DRAM(медленно но дёшево)).
+ Кэш процессора обычно состоит из нескольких уровней кэша (на некоторых уровнях кэш разделсяется между ядрами). Чем выше уровень тем выше скорость получения данных из него и тем он меньшего размера.
+ Данные из основной памяти в кэш считываются не побайтово а чанками, размер которых обычно 64 байта (так называемые кэш линии)

#### Пример 1.
Имеется массив:
``` 
int[] arr = new int[64 * 1024 * 1024];
```
Два примера, в первом пробегаемся по каждому 16-му элементу, а во втором по каждому первому:
```
for (int i = 0; i < arr.Length; i += 16)
  arr[i] *= 3;
 
for (int i = 0; i < arr.Length; i++) 
  arr[i] *= 3;
  ```
  Можно предположить что первый цикл отработает быстрее, но как показывают замеры, оба цикла занимают практически одинаковое количество циклов процессора (замеры проведены с помощью программы [vTune](https://software.intel.com/en-us/vtune)).
  ![](https://github.com/dkoleev/PerformanceTesting/blob/master/Content/Images/result_1.png)
